"use strict";(self["webpackChunkcompleted_pro"]=self["webpackChunkcompleted_pro"]||[]).push([[78],{2078:function(e,t,a){a.r(t),a.d(t,{default:function(){return u}});var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"category-manage"},[a("div",{staticClass:"add-btn"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("添加类目")])],1),a("el-table",{ref:"tableRef",attrs:{data:e.tableList,height:"calc(100vh - 320px)",border:""}},e._l(e.tableColumnList,(function(t){return a("el-table-column",{key:t.prop,attrs:{label:t.label,prop:t.prop,align:"center",width:t.width,"show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(i){var s=i.row;return["operation"===t.prop?a("div",[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleEdit(s)}}},[e._v("编辑")]),a("el-divider",{attrs:{direction:"vertical"}}),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDel(s)}}},[e._v("删除")])],1):a("div",{staticClass:"el-tooltip cell no-padding"},[e._v(e._s(s[t.prop]))])]}}],null,!0)})})),1),a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, jumper","current-page":e.page,"page-size":e.size,total:e.total},on:{"current-change":e.handleChange}}),a("category-operation-dialog",{attrs:{visible:e.visible,title:e.title,id:e.editId},on:{"update:visible":function(t){e.visible=t},"update-data":e.handleUpdateData}})],1)},s=[],l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"notes-operation-dialog"},[a("el-dialog",{attrs:{title:e.title,visible:e.visible,"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":e.handleClose,width:"800px"},on:{"update:visible":function(t){e.visible=t},open:e.init}},[a("div",{staticClass:"dialog-container"},[a("el-form",{ref:"formRef",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"名称：",prop:"title"}},[a("el-input",{attrs:{placeholder:"请输入名称",clearable:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"排序：",prop:"instruction"}},[a("el-input",{attrs:{placeholder:"请输入排序",clearable:""},model:{value:e.form.index,callback:function(t){e.$set(e.form,"index",t)},expression:"form.index"}})],1)],1)],1),a("template",{slot:"footer"},[a("el-button",{attrs:{type:"plain"},on:{click:e.handleClose}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],2)],1)},r=[],o={name:"NotesOperationDialog",props:{visible:{type:Boolean,default:()=>!1},title:{type:String,default:()=>"请输入标题"},id:{type:Number,default:()=>0}},data(){const e={name:[{required:!0,trigger:"blur",message:"不能为空"}],index:[{required:!0,trigger:"blur",message:"不能为空"}]};return{form:{name:"",index:""},rules:e}},methods:{init(){"编辑类目"===this.title&&this.getCategoryDetail()},handleClose(){return this.form={name:"",index:""},this.$emit("update:visible",!1),!1},async handleConfirm(){"添加类目"===this.title?await this.handleAdd():await this.handleEdit(),this.$emit("update-data",!1),this.handleClose()},async getCategoryDetail(){try{this.loading=!0;const e={id:this.id},t=await this.$api.server.getCategoryDetail(e);if(1===t.code){const e=t.data.category;this.form.name=e.name,this.form.index=e.index}else this.$message.error(t.msg)}catch(e){this.$message.error("发生错误")}finally{this.loading=!1}},async handleAdd(){try{const e=this.form,t=await this.$api.server.addCategory(e);1===t.code?this.$message.success(t.msg):this.$message.error(t.msg)}catch(e){this.$message.error("发生错误")}},async handleEdit(){try{const e=this.form;e.id=this.id;const t=await this.$api.server.editCategory(e);1===t.code?this.$message.success(t.msg):this.$message.error(t.msg)}catch(e){this.$message.error("发生错误")}}}},n=o,d=a(3736),c=(0,d.Z)(n,l,r,!1,null,"43e16d48",null),h=c.exports,p={name:"CategoryManage",components:{CategoryOperationDialog:h},data(){const e=[{label:"ID",prop:"id"},{label:"名称",prop:"name"},{label:"排序",prop:"index"},{label:"操作",prop:"operation"}],t=[{id:1,name:"标题1",index:"1"}];return{tableColumnList:e,tableList:t,page:1,size:10,total:0,loading:!1,visible:!1,title:"",editId:0}},methods:{handleUpdateData(){this.getCategory()},handleAdd(){this.title="添加类目",this.visible=!0},handleEdit({id:e}){this.editId=e,this.title="编辑类目",this.visible=!0},async handleDel({id:e}){try{await this.$confirm("此操作将永久删除该类目，是否继续？","提示",{type:"warning"});const t={id:e};await this.$api.server.delCategory(t),this.$message.success("删除成功"),await this.getCategory()}catch(t){this.$message.info("取消删除")}},handleChange(e){this.page=e,this.getCategory()},async getCategory(){try{this.loading=!0;const e={page:this.page,size:this.size},t=await this.$api.server.getCategory(e);if(1===t.code){const e=t.data;this.tableList=e.categoryList.sort(((e,t)=>e.index-t.index)),this.total=e.total}else this.$message.error(t.msg)}catch(e){this.$message.error("发生错误")}finally{this.loading=!1}}},created(){this.getCategory()}},g=p,m=(0,d.Z)(g,i,s,!1,null,"e1dc3daa",null),u=m.exports}}]);